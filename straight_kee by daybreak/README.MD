# straight_kee by daybreak
### https://crackmes.one/crackme/5ab77f5c33c5d40ad448c653

Difficult crackme. Function under 0x4011F0 do a lot, but most important is read login (at first call), and password (second call) to address pointed at [esp -8] (inside function)
Next there are some calculation (like login length, calculating address in code section, where bytes to xor are allocated etc)

Each 4 bytes from instructions in range: <0x40104b, 0x401082> are replaced by:

`these bytes` XOR `first reverted 4 letters of login`

algorithm looks like:
1) take 4 bytes from 0x401083
2) take 4 bytes from login address (0x403060)
3) xor bytes, store result at 0x403087
4) increment address 0x401083 by 1, do same with login address, result address move by 4 bytes (xor result is 4 bytes number)
5) repeat steps 1 - 4 7 times yet

Next function works on already calculated values:
algorithm starts from: 0x401174

1) take byte from 0x403087 to al
2) shift left by 6 bytes
3) switch ah & al
4) get value from array (reference in EBX) & store it in result (under 0x4030AF)
5) shift right by 6
6) substract "rotator" (currently 6) by 2
7) if rotator is equal to 0
8) get value from array (referenced in EBX) using ah & store it in result
9) decrement rotations count in EDX register (it is done at the beginning) & check if value here is not 0
10) repeat algorithm using next addresses (like: 0x403088, rotation now by 4, storing at next result address etc)

Password is first 8 chars generated by algorithm
